{"node_id": "c350c400", "title": "Review tool calls", "path": "use-functional-api > Use the functional API > Human-in-the-loop > Review tool calls", "content": "To review tool calls before execution, we add a `review_tool_call` function that calls [`interrupt`](/oss/python/langgraph/interrupts#pause-using-interrupt). When this function is called, execution will be paused until we issue a command to resume it.\n\nGiven a tool call, our function will [`interrupt`](https://reference.langchain.com/python/langgraph/types/#langgraph.types.interrupt) for human review. At that point we can either:\n\n* Accept the tool call\n* Revise the tool call and continue\n* Generate a custom tool message (e.g., instructing the model to re-format its tool call)\n\n```python  theme={null}\nfrom typing import Union\n\ndef review_tool_call(tool_call: ToolCall) -> Union[ToolCall, ToolMessage]:\n    \"\"\"Review a tool call, returning a validated version.\"\"\"\n    human_review = interrupt(\n        {\n            \"question\": \"Is this correct?\",\n            \"tool_call\": tool_call,\n        }\n    )\n    review_action = human_review[\"action\"]\n    review_data = human_review.get(\"data\")\n    if review_action == \"continue\":\n        return tool_call\n    elif review_action == \"update\":\n        updated_tool_call = {**tool_call, **{\"args\": review_data}}\n        return updated_tool_call\n    elif review_action == \"feedback\":\n        return ToolMessage(\n            content=review_data, name=tool_call[\"name\"], tool_call_id=tool_call[\"id\"]\n        )\n```\n\nWe can now update our [entrypoint](/oss/python/langgraph/functional-api#entrypoint) to review the generated tool calls. If a tool call is accepted or revised, we execute in the same way as before. Otherwise, we just append the [`ToolMessage`](https://reference.langchain.com/python/langchain/messages/#langchain.messages.ToolMessage) supplied by the human. The results of prior tasks — in this case the initial model call — are persisted, so that they are not run again following the [`interrupt`](https://reference.langchain.com/python/langgraph/types/#langgraph.types.interrupt).\n\n```python  theme={null}\nfrom langgraph.checkpoint.memory import InMemorySaver\nfrom langgraph.graph.message import add_messages\nfrom langgraph.types import Command, interrupt\n\n\ncheckpointer = InMemorySaver()\n\n\n@entrypoint(checkpointer=checkpointer)\ndef agent(messages, previous):\n    if previous is not None:\n        messages = add_messages(previous, messages)\n\n    model_response = call_model(messages).result()\n    while True:\n        if not model_response.tool_calls:\n            break\n\n        # Review tool calls\n        tool_results = []\n        tool_calls = []\n        for i, tool_call in enumerate(model_response.tool_calls):\n            review = review_tool_call(tool_call)\n            if isinstance(review, ToolMessage):\n                tool_results.append(review)\n            else:  # is a validated tool call\n                tool_calls.append(review)\n                if review != tool_call:\n                    model_response.tool_calls[i] = review  # update message\n\n        # Execute remaining tool calls\n        tool_result_futures = [call_tool(tool_call) for tool_call in tool_calls]\n        remaining_tool_results = [fut.result() for fut in tool_result_futures]\n\n        # Append to message list\n        messages = add_messages(\n            messages,\n            [model_response, *tool_results, *remaining_tool_results],\n        )\n\n        # Call model again\n        model_response = call_model(messages).result()\n\n    # Generate final response\n    messages = add_messages(messages, model_response)\n    return entrypoint.final(value=model_response, save=messages)\n```", "summary": "Describes implementing a human-in-the-loop review for tool calls using the `interrupt` function to pause execution, allowing acceptance, revision, or custom feedback before proceeding.", "keywords": ["interrupt", "ToolCall", "ToolMessage", "review_tool_call", "entrypoint", "human-in-the-loop", "InMemorySaver", "call_model", "call_tool", "add_messages"]}