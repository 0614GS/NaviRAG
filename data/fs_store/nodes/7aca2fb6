{"node_id": "7aca2fb6", "title": "Using Messages in your Graph", "path": "graph-api > Graph API overview > State > Working with Messages in Graph State > Using Messages in your Graph", "content": "In many cases, it is helpful to store prior conversation history as a list of messages in your graph state. To do so, we can add a key (channel) to the graph state that stores a list of `Message` objects and annotate it with a reducer function (see `messages` key in the example below). The reducer function is vital to telling the graph how to update the list of `Message` objects in the state with each state update (for example, when a node sends an update). If you don't specify a reducer, every state update will overwrite the list of messages with the most recently provided value. If you wanted to simply append messages to the existing list, you could use `operator.add` as a reducer.\n\nHowever, you might also want to manually update messages in your graph state (e.g. human-in-the-loop). If you were to use `operator.add`, the manual state updates you send to the graph would be appended to the existing list of messages, instead of updating existing messages. To avoid that, you need a reducer that can keep track of message IDs and overwrite existing messages, if updated. To achieve this, you can use the prebuilt [`add_messages`](https://reference.langchain.com/python/langgraph/graphs/#langgraph.graph.message.add_messages) function. For brand new messages, it will simply append to existing list, but it will also handle the updates for existing messages correctly.", "summary": "Explains how to manage message lists in graph state using reducer functions, including appending with operator.add and updating existing messages with add_messages.", "keywords": ["Message", "graph state", "reducer function", "operator.add", "add_messages", "state update", "message IDs", "conversation history", "manual update", "human-in-the-loop"]}